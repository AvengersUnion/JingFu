<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.app.dao.ServiceDao" >
	<sql id="serviceColumn">
		a.id as "id",
		a.sn as "name",
		a.ig as "ig",
		a.period as "period",
		a.price as "price",
		a.prepay as "prepay",
		a.discount as "discount",
		a.ss as "summary",
		a.sd as "details",
		a.region_rc as "region_rc",
		a.aip as "ad_img_path",
		a.ain as "ad_img_name",
		a.dip as "det_img_path",
		a.din as "det_img_name",
		a.tp as "tp",
		a.stt as "stt",
		a.od as "od"
	</sql>
	
	<sql id="serviceJoins">
		left join dict d on a.tp = d.ky
	</sql>
	<!-- 首页获取一级服务列表 -->
	<select id="getAllService" resultType="map">
		select 
			distinct d.ky,d.vl
		from 
			dict d
		where d.tp = 'SER'
	</select>
  <!--获取一级服务的子服务列表-->
  <select id="getsubListByType"  resultType="com.app.entity.Service">
    select
    	a.id as "id",
		a.sn as "name"
     from 
     	service a 
     WHERE  TP = #{type}

  </select>

  <!--获取单个服务的详情-->
  <select id="getdetailListById"  resultType="com.app.entity.Service">
    select 
    	<include refid="serviceColumn"></include>
    from 
    	service a 
    WHERE  ID = #{id}

  </select>


  <!--获取登陆图片-->
  <select id="loginImage"  resultType="com.app.entity.Image">

    select * from image WHERE TP ='IMG_L'

  </select>

  <!--获取广告图片-->
  <select id="advertImage"  resultType="com.app.entity.Image">

    select * from image WHERE TP='IMG_A'

  </select>



  <!--保存服务订单-->
  <insert id="saveOrder" parameterType="com.app.entity.Service" >
    INSERT INTO service_order
    (
    ID,CUSTOMER_ID,ADDRESS_ID,SERVICE_ID,SC,DISCOUNT,CT,STT
    )
    VALUES
    (
    #{serviceOrder.ID},#{serviceOrder.CUSTOMER_ID},#{serviceOrder.ADDRESS_ID},#{serviceOrder.SERVICE_ID},#{serviceOrder.SC},#{serviceOrder.DISCOUNT},#{serviceOrder.CT},#{serviceOrder.STT}
    )
  </insert>


</mapper>